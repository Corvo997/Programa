<link href="css/style.css" rel='stylesheet' type='text/css' />

    
    
    <div id="nselecionou" ondrop="return dragDrop(event)" ondragover="return dragOver(event)">
    	Não selecionadas
    	<div id="cUF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    	 <label>Código da UF</label>	
    	</div>
    	
    	<div id="cNF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código Numérico</label>
    	</div>
    	<div id="natOp" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Naturezaa da Operação</label>
    	</div>
    	<div id="indPag" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Forma de Pagamento</label>
    	</div>
    	<div id="mod" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Modelo Documento Fiscal</label>
    	</div>
    	<div id="serie" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Série do Documento</label>
    	</div>
    	<div id="nNF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Número do Documento</label>
    	</div>
    	<div id="dhEmi" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Data de emissão</label>
    	</div>
    	<div id="dhSaiEnt" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Data de saída ou entrada</label>
    	</div>
    	<div id="tpNF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Tipo de operação</label>
    	</div>
    	<div id="cMunFG" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código do Município</label>
    	</div>
    	<div id="tpImp" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Formato de Impressão</label>
    	</div>
    	<div id="tpEmis" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Tipo de Emissão</label>
    	</div>
    	<div id="cDV" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Dígito Verificador</label>
    	</div>
    	<div id="tpAmb" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Identificação do Ambiente</label>
    	</div>
    	<div id="finNFe" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Finalidade de emissão</label>
    	</div>
    	<div id="idDest" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Id do Destinatário</label>
    	</div>
    	<div id="indFinal" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Índice Final</label>
    	</div>
    	<div id="indPres" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Índice Pres</label> 
    	</div>
    	<div id="procEmi" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Processo de emissão</label>
    	</div>
    	<div id="verProc" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Versão do Processo</label>
    	</div>
    	<div id="emitCNPJ" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>CNPJ do emitente</label>
    	</div>
    	<div id="emitCPF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>CPF do emitente</label>
    	</div>
    	<div id="emitxNome" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome do Emitente</label>
    	</div>
    	<div id="emitxFant" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome Fantasia do Emitente</label>
    	</div>
    	<div id="emitxLgr" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Logradouro Emitente</label>
    	</div>
    	<div id="emitnro" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Número Emitente</label>
    	</div>
    	<div id="emitxBairro" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Bairro Emitente</label>
    	</div>
    	<div id="emitcMun" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código do município do Emitente</label>
    	</div>
    	<div id="emitxMun" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome do município do emitente</label>
    	</div>
    	<div id="emitUF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>UF Emitente</label>
    	</div>
    	<div id="emitCEP" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>CEP Emitente</label>
    	</div>
    	<div id="emitcPais" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código País Emitente</label>
    	</div>
    	<div id="emitxPais" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome País Emitente</label>
    	</div>
    	<div id="emitfone" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Telefone Emitente</label>
    	</div>
    	<div id="emitIE" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>IE Emitente</label>
    	</div>
    	<div id="emitCRT" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código de Regime Tributário Emitente</label>
    	</div>
    	<div id="emitxCpl" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Complemento Emitente</label>
    	</div>
    	<div id="destCNPJ" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>CNPJ do Destinatário</label>
    	</div>
    	<div id="destCPF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>CPF do Destinatário</label>
    	</div>
    	<div id="destxNome" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome do Destinatário</label>
    	</div>
    	<div id="destxFant" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome Fantasia do Destinatário</label>
    	</div>
    	<div id="destLgr" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Logradouro do Destinatário</label>
    	</div>
    	<div id="destnro" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Número do Destinatário</label>
    	</div>
    	<div id="destxBairro" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Bairro Destinatário</label>
    	</div>
    	<div id="destcMun" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código Município Destinatário</label>
    	</div>
    	<div id="destxMun" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome município Destinatário</label>
    	</div>
    	<div id="destUF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>UF Destinatário</label>
    	</div>
    	<div id="destCEP" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>CEP Destinatário</label>
    	</div>
    	<div id="destcPais" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código País Destinatário</label>
    	</div>
    	<div id="destxPais" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome País Destinatário</label>
    	</div>
    	<div id="destFone" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Fone Destinatário</label>
    	</div>
    	<div id="destIE" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>IE Destinatário</label>
    	</div>
    	<div id="destCpl" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Complemento do Destinatário</label>
    	</div>
    	<div id="cProd" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código do Produto</label>
    	</div>
    	<div id="xProd" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Descrição do Produto</label>
    	</div>
    	<div id="NCM" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código NCM</label>
    	</div>
    	<div id="CFOP" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Código Fiscal de Operações</label>
    	</div>
    	<div id="uCom" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Unidade Comercial</label>
    	</div>
    	<div id="qCom" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Quantidade Comercial</label>
    	</div>
    	<div id="vUnCom" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Unitário de Comercialização</label>
    	</div>
    	<div id="vProd" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Toal Bruto</label>
    	</div>
    	<div id="uTrib" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Unidade Tributável</label>
    	</div>
    	<div id="qTrib" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Quantidade Tributável</label>
    	</div>
    	<div id="vUnTrib" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Unitário de tributação</label>
    	</div>
    	<div id="vOutro" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Outras despesas</label>
    	</div>
    	<div id="indTot" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Indicador de entrada do item no total</label>
    	</div>
    	<div id="ICMSorig" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Origem da mercadoria ICMS</label>
    	</div>
    	<div id="ICMSCST" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Tributação ICMS</label>
    	</div>
    	<div id="ICMSmodBC" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Modalidade BC do ICMS</label>
    	</div>
    	<div id="ICMSvBC" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor da BC ICMS</label>
    	</div>
    	<div id="pICMS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Alíquota do ICMS</label>
    	</div>
    	<div id="vICMS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor do ICMS</label>
    	</div>
    	<div id="ICMSvBCSTRet" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor BC do ICMS ST retido</label>
    	</div>
    	<div id="vICMSSTRet" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor do ICMS retido</label>
    	</div>
    	<div id="PISCST" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Tributação do PIS</label>
    	</div>
    	<div id="PISvBC" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor BC do PIS</label>
    	</div>
    	<div id="pPIS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Alíquota do PIS(percentual)</label>
    	</div>
    	<div id="vPIS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor do PIS</label>
    	</div>
    	<div id="PISqBCProd" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Quantidade Vendida PIS</label>
    	</div>
    	<div id="PISvAliqProd" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Alíquota do PIS(reais)</label>
    	</div>
    	<div id="COFINSCST" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Tributação COFINS</label>
    	</div>
    	<div id="COFINSvBC" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor BC da COFINS</label>
    	</div>
    	<div id="pCOFINS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Alíquota da COFINS(percentual)</label>
    	</div>
    	<div id="vCOFINS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor do COFINS</label>
    	</div>
    	<div id="COFINSqBCProd" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Quantidade Vendida COFINS</label>
    	</div>
    	<div id="COFINSvAliqProd" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Alíquota do COFINS(reais)</label>
    	</div>
    	<div id="totalvBC" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>BC total do ICMS</label>
    	</div>
    	<div id="totalvICMS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total do ICMS</label>
    	</div>
    	<div id="totalvBCST" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>BC do ICMS ST Total</label>
    	</div>
    	<div id="totalvST" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total do ICMS ST</label>
    	</div>
    	<div id="totalvProd" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total dos Produtos</label>
    	</div>
    	<div id="totalvFrete" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total do Frete</label>
    	</div>
    	<div id="totalvSeg" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total do Seguro</label>
    	</div>
    	<div id="totalvDesc" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total do Desconto</label>
    	</div>
    	<div id="totalvII" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total do II</label>
    	</div>
    	<div id="totalvIPI" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total do IPI</label>
    	</div>
    	<div id="totalvPIS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor do PIS</label>
    	</div>
    	<div id="totalvCOFINS" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor do COFINS</label>
    	</div>
    	<div id="totalvOutro" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Total de Outras Despesas</label>
    	</div>
    	<div id="totalvNF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total da NF</label>
    	</div>
    	<div id="totalvFCPUFDest" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total FCP UF Destinatário</label>
    	</div>
    	<div id="totalvICMSUFRemet" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total ICMS UF Remetente </label>
    	</div>
    	<div id="totalvICMSDeson" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Total do ICMS Deson</label>
    	</div>
    	<div id="totalvICMSUFDest" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Totaldo ICMS UF Destinatário</label>
    	</div>
    	<div id="transpmodFrete" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Modalidade do frete</label>
    	</div>
    	<div id="transpCNPJ" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>CNPJ do Transporte</label>
    	</div>
    	<div id="transpCPF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>CPF do Transporte</label>
    	</div>
    	<div id="transpxNome" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome do Transporte</label>
    	</div>
    	<div id="transpIE" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Inscrição Estadual do Transporte</label>
    	</div>
    	<div id="transpxEnder" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Endereço Completo do Transporte</label>
    	</div>
    	<div id="transpxMun" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Nome do Município do Transporte</label>
    	</div>
    	<div id="transpUF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>UF do Transporte</label>
    	</div>
    	<div id="transpplaca" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Placa do Veículo</label>
    	</div>
    	<div id="transpUF" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>UF do Veículo</label>
    	</div>
    	<div id="transpqVol" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Quantidade de volumes transportados</label>
    	</div>
    	<div id="transpesp" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Espécie dos volumes transportados</label>
    	</div>
    	<div id="transppesoL" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Peso Líquido</label>
    	</div>
    	<div id="transppesoB" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Peso Bruto</label>
    	</div>
    	<div id="cobrnFat" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Número da Fatura</label>
    	</div>
    	<div id="cobrvOrig" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Original da Fatura</label>
    	</div>
    	<div id="cobrvLiq" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor Líquido da Fatura</label>
    	</div>
    	<div id="cobrnDup" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Número da Duplicata</label>
    	</div>
    	<div id="cobrdVenc" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Data de Vencimento</label>
    	</div>
    	<div id="cobrvDup" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Valor da duplicata</label>
    	</div>
    	<div id="InfCpl" draggable="true" ondragstart="return dragStart(event)" class="opcao">
    		<label>Informações Complementares</label>
    	</div>
    </div>

    <div id="selecionou" ondrop="return dragDrop(event)" ondragover="return dragOver(event)">
    	Selecionadas
    </div>
    
    
 <script type="text/javascript">
    function dragStart(ev){
      ev.dataTransfer.setData("ID",ev.target.getAttribute('id'));
    }
    function dragOver(ev){
      return false;
    }
    function dragDrop(acao){
    	var opcaoSelecionado = acao.dataTransfer.getData("ID");
    	acao.target.appendChild(document.getElementById(opcaoSelecionado));
    }

	function exportarParaExcel() {

    array_teste = `SELECT * FROM nota_fiscal INNER JOIN produto ON id_nota_fiscal = id`;

	dados = [];


	db.all(array_teste, [], (err, rows) => {
	  if (err) {
	    throw err;
	  }
	  rows.forEach((row) => {
	  	dados.push(Object.keys(row).map(function(_) { return row[_]; }));
	  });
		csvContent = "data:text/csv;charset=utf-8," 
	    + dados.map(e => e.join(";")).join("\n");
		var encodedUri = encodeURI(csvContent);
		var link = document.createElement("a");
		link.setAttribute("href", encodedUri);
		link.setAttribute("download", "my_data.csv");
		document.body.appendChild(link); // Required for FF

		link.click(); // This will download the data file named "my_data.csv".
	});

	}

	exportarParaExcel();
    
   
  
    
</script>