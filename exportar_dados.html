<link href="css/style.css" rel='stylesheet' type='text/css' />
        
          
            <div class="wrapper">
            <label id="title">Não Selecionadas</label>
              <div id="nselecionou" class="box">
                   <div campo="codigo_uf_emitente" id="task1" draggable="true" class="opcao">
                	 <label>Código da UF</label>	
                	</div>
                	<div campo="codigo_chave_acesso" id="task2" draggable="true" class="opcao">
                		<label>Código Numérico</label>
                	</div>
                	<div campo="natureza_operacao" id="task3" draggable="true" class="opcao">
                		<label>Natureza da Operação</label>
                	</div>
                	<div campo="forma_pagamento" id="task4" draggable="true" class="opcao">
                		<label>Forma de Pagamento</label>
                	</div>
                	<div campo="modelo_documento_fiscal" id="task5" draggable="true" class="opcao">
                		<label>Modelo Documento Fiscal</label>
                	</div>
                	<div campo="serie_documento_fiscal" id="task6" draggable="true" class="opcao">
                		<label>Série do Documento</label>
                	</div>
                	<div campo="numero_documento_fiscal" id="task7" draggable="true" class="opcao">
                		<label>Número do Documento</label>
                	</div>
                	<div campo="data_hora_emissao" id="task8" draggable="true" class="opcao">
                		<label>Data de emissão</label>
                	</div>
                	<div campo="data_hora_saida_entrada" id="task9" draggable="true" class="opcao">
                		<label>Data de saída ou entrada</label>
                	</div>
                	<div campo="tipo_operacao" id="task10" draggable="true" class="opcao">
                		<label>Tipo de operação</label>
                	</div>
                	<div campo="codigo_municipio_fato_gerador" id="task11" draggable="true" class="opcao">
                		<label>Código do Município</label>
                	</div>
                	<div campo="formato_impressao" id="task12" draggable="true" class="opcao">
                		<label>Formato de Impressão</label>
                	</div>
                	<div campo="tipo_emissao" id="task13" draggable="true" class="opcao">
                		<label>Tipo de Emissão</label>
                	</div>
                	<div campo="digito_verificador_chave_acesso" id="task14" draggable="true" class="opcao">
                		<label>Dígito Verificador</label>
                	</div>
                	<div campo="tipo_ambiente" id="task15" draggable="true" class="opcao">
                		<label>Identificação do Ambiente</label>
                	</div>
                	<div campo="finalidade_emissao_nf" id="task16" draggable="true" class="opcao">
                		<label>Finalidade de emissão</label>
                	</div>
                	<div campo="indFinal" id="task18" draggable="true" class="opcao">
                		<label>Índice Final</label>
                	</div>
                	<div campo="indPres" id="task19" draggable="true" class="opcao">
                		<label>Índice Pres</label> 
                	</div>
                	<div campo="processo_emissao_nfe" id="task20" draggable="true" class="opcao">
                		<label>Processo de emissão</label>
                	</div>
                	<div campo="versao_processo_emissao_nfe" id="task21" draggable="true" class="opcao">
                		<label>Versão do Processo</label>
                	</div>
                	<div campo="cnpj_emitente" id="task22" draggable="true" class="opcao">
                		<label>CNPJ do emitente</label>
                	</div>
                	<div campo="cpf_emitente" id="task23" draggable="true" class="opcao">
                		<label>CPF do emitente</label>
                	</div>
                	<div campo="razao_social_nome_emitente" id="task24" draggable="true" class="opcao">
                		<label>Nome do Emitente</label>
                	</div>
                	<div campo="nome_fantasia_emitente" id="task25" draggable="true" class="opcao">
                		<label>Nome Fantasia do Emitente</label>
                	</div>
                	<div campo="logradouro_emitente" id="task26" draggable="true" class="opcao">
                		<label>Logradouro Emitente</label>
                	</div>
                	<div campo="numero_emitente" id="task27" draggable="true" class="opcao">
                		<label>Número Emitente</label>
                	</div>
                	<div campo="bairro_emitente" id="task28" draggable="true" class="opcao">
                		<label>Bairro Emitente</label>
                	</div>
                	<div campo="codigo_municipio_emitente" id="task29" draggable="true" class="opcao">
                		<label>Código do município do Emitente</label>
                	</div>
                	<div campo="municipio_emitente" id="task30" draggable="true" class="opcao">
                		<label>Nome do município do emitente</label>
                	</div>
                	<div campo="uf_sigla_emitente" id="task31" draggable="true" class="opcao">
                		<label>UF Emitente</label>
                	</div>
                	<div campo="codigo_cep_emitente" id="task32" draggable="true" class="opcao">
                		<label>CEP Emitente</label>
                	</div>
                	<div campo="codigo_pais_emitente" id="task33" draggable="true" class="opcao">
                		<label>Código País Emitente</label>
                	</div>
                	<div campo="pais_emitente" id="task34" draggable="true" class="opcao">
                		<label>Nome País Emitente</label>
                	</div>
                	<div campo="telefone_emitente" id="task35" draggable="true" class="opcao">
                		<label>Telefone Emitente</label>
                	</div>
                	<div campo="codigo_regime_tributario_emitente" id="task37" draggable="true" class="opcao">
                		<label>Código de Regime Tributário Emitente</label>
                	</div>
                	<div campo="complemento_emitente" id="task38" draggable="true" class="opcao">
                		<label>Complemento Emitente</label>
                	</div>
                	<div campo="cnpj_destinatario" id="task39" draggable="true" class="opcao">
                		<label>CNPJ do Destinatário</label>
                	</div>
                	<div campo="cpf_destinatario" id="task40" draggable="true" class="opcao">
                		<label>CPF do Destinatário</label>
                	</div>
                	<div campo="razao_social_nome_destinatario" id="task41" draggable="true" class="opcao">
                		<label>Nome do Destinatário</label>
                	</div>
                	<div campo="nome_fantasia_destinatario" id="task42" draggable="true" class="opcao">
                		<label>Nome Fantasia do Destinatário</label>
                	</div>
                	<div campo="logradouro_destinatario" id="task43" draggable="true" class="opcao">
                		<label>Logradouro do Destinatário</label>
                	</div>
                	<div campo="numero_destinatario" id="task44" draggable="true" class="opcao">
                		<label>Número do Destinatário</label>
                	</div>
                	<div campo="bairro_destinatario" id="task45" draggable="true" class="opcao">
                		<label>Bairro Destinatário</label>
                	</div>
                	<div campo=" codigo_municipio_destinatario" id="task46" draggable="true" class="opcao">
                		<label>Código Município Destinatário</label>
                	</div>
                	<div campo="municipio_destinatario" id="task47" draggable="true" class="opcao">
                		<label>Nome município Destinatário</label>
                	</div>
                	<div campo="uf_sigla_destinatario" id="task48" draggable="true" class="opcao">
                		<label>UF Destinatário</label>
                	</div>
                	<div campo="codigo_cep_destinatario" id="task49" draggable="true" class="opcao">
                		<label>CEP Destinatário</label>
                	</div>
                	<div campo="codigo_pais_destinatario" id="task50" draggable="true" class="opcao">
                		<label>Código País Destinatário</label>
                	</div>
                	<div campo="pais_destinatario" id="task51" draggable="true" class="opcao">
                		<label>Nome País Destinatário</label>
                	</div>
                	<div campo="telefone_destinatario" id="task52" draggable="true" class="opcao">
                		<label>Fone Destinatário</label>
                	</div>
                	<div campo="codigo_regime_tributario_destinatario" id="task53" draggable="true" class="opcao">
                		<label>IE Destinatário</label>
                	</div>
                	<div campo="complemento_destinatario" id="task54" draggable="true" class="opcao">
                		<label>Complemento do Destinatário</label>
                	</div>
                	<div campo="codigo_produto" id="task55" draggable="true" class="opcao">
                		<label>Código do Produto</label>
                	</div>
                	<div campo="descricao_produto" id="task56" draggable="true" class="opcao">
                		<label>Descrição do Produto</label>
                	</div>
                	<div campo="codigo_ncm" id="task57" draggable="true" class="opcao">
                		<label>Código NCM</label>
                	</div>
                	<div campo="codigo_fiscal_operacoes_prestacoes" id="task58" draggable="true" class="opcao">
                		<label>Código Fiscal de Operações</label>
                	</div>
                	<div campo="unidade_comercial" id="task59" draggable="true" class="opcao">
                		<label>Unidade Comercial</label>
                	</div>
                	<div campo="quantidade_comercial" id="task60" draggable="true" class="opcao">
                		<label>Quantidade Comercial</label>
                	</div>
                	<div campo="valor_unitario_comercial" id="task61" draggable="true" class="opcao">
                		<label>Valor Unitário de Comercialização</label>
                	</div>
                	<div campo="valor_total_produtos_e_servicos" id="task62" draggable="true" class="opcao">
                		<label>Valor Toal Bruto</label>
                	</div>
                	<div campo="unidade_tributavel" id="task63" draggable="true" class="opcao">
                		<label>Unidade Tributável</label>
                	</div>
                	<div campo="quantidade_tributavel" id="task64" draggable="true" class="opcao">
                		<label>Quantidade Tributável</label>
                	</div>
                	<div campo="valor_unitario_tributacao" id="task65" draggable="true"class="opcao">
                		<label>Valor Unitário de tributação</label>
                	</div>
                	<div campo="outras_despesas" id="task66" draggable="true" class="opcao">
                		<label>Outras despesas</label>
                	</div>
                	<div campo="valor_item_entra_no_total_nf" id="task67" draggable="true" class="opcao">
                		<label>Indicador de entrada do item no total</label>
                	</div>
                	<div campo="ICMS_origem_mercadoria" id="task68" draggable="true" class="opcao">
                		<label>Origem da mercadoria ICMS</label>
                	</div>
                	<div campo="ICMS_tributaçao" id="task69" draggable="true" class="opcao">
                		<label>Tributação ICMS</label>
                	</div>
                	<div campo="modalidade_determinaçao_BC" id="task70" draggable="true" class="opcao">
                		<label>Modalidade BC do ICMS</label>
                	</div>
                	<div campo="valor_BC_ICMS" id="task71" draggable="true" class="opcao">
                		<label>Valor da BC ICMS</label>
                	</div>
                	<div campo="aliquota_imposto_ICMS" id="task72" draggable="true" class="opcao">
                		<label>Alíquota do ICMS</label>
                	</div>
                	<div campo="valor_ICMS" id="task73" draggable="true" class="opcao">
                		<label>Valor do ICMS</label>
                	</div>
                	<div campo="valor_BC_ICMSST_retido" id="task74" draggable="true" class="opcao">
                		<label>Valor BC do ICMS ST retido</label>
                	</div>
                	<div campo="valor_ICMSST_retido" id="task75" draggable="true" class="opcao">
                		<label>Valor do ICMS retido</label>
                	</div>
                	<div campo="codigo_situação_tributaria_PIS" id="task76" draggable="true" class="opcao">
                		<label>Tributação do PIS</label>
                	</div>
                	<div campo="valor_base_calculo_PIS" id="task77" draggable="true" class="opcao">
                		<label>Valor BC do PIS</label>
                	</div>
                	<div campo="aliquota_PIS_percentual" id="task78" draggable="true" class="opcao">
                		<label>Alíquota do PIS(percentual)</label>
                	</div>
                	<div campo="valor_PIS" id="task79" draggable="true" class="opcao">
                		<label>Valor do PIS</label>
                	</div>
                	<div campo="quantidade_vendida_PIS" id="task80" draggable="true" class="opcao">
                		<label>Quantidade Vendida PIS</label>
                	</div>
                	<div campo="aliquota_PIS_reais" id="task81" draggable="true"class="opcao">
                		<label>Alíquota do PIS(reais)</label>
                	</div>
                	<div campo="codigo_situaçao_tributaria_COFINS" id="task82" draggable="true" class="opcao">
                		<label>Tributação COFINS</label>
                	</div>
                	<div campo="valor_base_calculo_COFINS" id="task83" draggable="true" class="opcao">
                		<label>Valor BC da COFINS</label>
                	</div>
                	<div campo="aliquota_COFINS_percentual" id="task84" draggable="true" class="opcao">
                		<label>Alíquota da COFINS(percentual)</label>
                	</div>
                	<div campo="valor_COFINS" id="task85" draggable="true" class="opcao">
                		<label>Valor do COFINS</label>
                	</div>
                	<div campo="quantidade_vendida_COFINS" id="task86" draggable="true" class="opcao">
                		<label>Quantidade Vendida COFINS</label>
                	</div>
                	<div campo="aliquota_COFINS_reais" id="task87" class="opcao">
                		<label>Alíquota do COFINS(reais)</label>
                	</div>
                	<div campo="base_calculo_icms" id="task88" draggable="true" class="opcao">
                		<label>BC total do ICMS</label>
                	</div>
                	<div campo="valor_total_icms" id="task89" draggable="true"class="opcao">
                		<label>Valor Total do ICMS</label>
                	</div>
                	<div campo="base_calculo_icmsst" id="task90" draggable="true" class="opcao">
                		<label>BC do ICMS ST Total</label>
                	</div>
                	<div campo="valor_total_icmsst" id="task91" draggable="true" class="opcao">
                		<label>Valor Total do ICMS ST</label>
                	</div>
                	<div campo="valor_total_produtos_e_servicos" id="task92" draggable="true" class="opcao">
                		<label>Valor Total dos Produtos</label>
                	</div>
                	<div campo="valor_total_frete" id="task93" draggable="true" class="opcao">
                		<label>Valor Total do Frete</label>
                	</div>
                	<div campo="valor_total_seguro" id="task94" draggable="true" class="opcao">
                		<label>Valor Total do Seguro</label>
                	</div>
                	<div campo="valor_total_desconto" id="task95" draggable="true" class="opcao">
                		<label>Valor Total do Desconto</label>
                	</div>
                	<div campo="valor_total_ii" id="task96" draggable="true" class="opcao">
                		<label>Valor Total do II</label>
                	</div>
                	<div campo="valor_total_ipi" id="task97" draggable="true"class="opcao">
                		<label>Valor Total do IPI</label>
                	</div>
                	<div campo="valor_total_pis" id="task98" draggable="true" class="opcao">
                		<label>Valor do PIS</label>
                	</div>
                	<div campo="valor_total_cofins" id="task99" draggable="true" class="opcao">
                		<label>Valor do COFINS</label>
                	</div>
                	<div campo="valor_total_outros" id="task100" draggable="true" class="opcao">
                		<label>Total de Outras Despesas</label>
                	</div>
                	<div campo="valor_total_nf" id="task101" draggable="true" class="opcao">
                		<label>Valor Total da NF</label>
                	</div>
                	<div campo="vFCPUFDest" id="task102" draggable="true" class="opcao">
                		<label>Valor Total FCP UF Destinatário</label>
                	</div>
                	<div campo="vICMSUFRemet" id="task103" draggable="true" class="opcao">
                		<label>Valor Total ICMS UF Remetente </label>
                	</div>
                	<div campo="vICMSDeson" id="task104" draggable="true" class="opcao">
                		<label>Valor Total do ICMS Deson</label>
                	</div>
                	<div campo="vICMSUFDest" id="task105" draggable="true" class="opcao">
                		<label>Valor Totaldo ICMS UF Destinatário</label>
                	</div>
                	<div campo="modalidade_frete" id="task106" draggable="true" class="opcao">
                		<label>Modalidade do frete</label>
                	</div>
                	<div campo="cnpj_transportador" id="task107" draggable="true" class="opcao">
                		<label>CNPJ do Transporte</label>
                	</div>
                	<div campo="cpf_transportador" id="task108" draggable="true" class="opcao">
                		<label>CPF do Transporte</label>
                	</div>
                	<div campo="razao_social_nome_transportador" id="task109" draggable="true" class="opcao">
                		<label>Nome do Transporte</label>
                	</div>
                	<div campo="inscricao_estadual_transportador" id="task110" draggable="true" class="opcao">
                		<label>Inscrição Estadual do Transporte</label>
                	</div>
                	<div campo="endereco_completo_transportador" id="task111" draggable="true" class="opcao">
                		<label>Endereço Completo do Transporte</label>
                	</div>
                	<div campo="nome_municipio_transportador" id="task112" draggable="true" class="opcao">
                		<label>Nome do Município do Transporte</label>
                	</div>
                	<div campo="uf_sigla_transportador" id="task113" draggable="true" class="opcao">
                		<label>UF do Transporte</label>
                	</div>
                	<div campo="placa_veiculo_transportador" id="task114" draggable="true"class="opcao">
                		<label>Placa do Veículo</label>
                	</div>
                	<div campo="sigla_veiculo_transportador" id="task115" draggable="true" class="opcao">
                		<label>UF do Veículo</label>
                	</div>
                	<div campo="quantidade_volumes_transportados" id="task116" draggable="true" class="opcao">
                		<label>Quantidade de volumes transportados</label>
                	</div>
                	<div campo="especie_volumes" id="task117" draggable="true" class="opcao">
                		<label>Espécie dos volumes transportados</label>
                	</div>
                	<div campo="peso_liquido" id="task118" draggable="true"class="opcao">
                		<label>Peso Líquido</label>
                	</div>
                	<div campo="peso_bruto" id="task119" draggable="true" class="opcao">
                		<label>Peso Bruto</label>
                	</div>
                	<div campo="numero_fatura" id="task120" draggable="true" class="opcao">
                		<label>Número da Fatura</label>
                	</div>
                	<div campo="valor_original" id="task121" draggable="true" class="opcao">
                		<label>Valor Original da Fatura</label>
                	</div>
                	<div campo="valor_liquido" id="task122" draggable="true" class="opcao">
                		<label>Valor Líquido da Fatura</label>
                	</div>
                	<div campo="numero_duplicata" id="task123" draggable="true"class="opcao">
                		<label>Número da Duplicata</label>
                	</div>
                </div>
            
              
        

             <label id="title2">Selecionadas</label>	
             <div style="float: right;"  id="selecionou" class="box">
                	<div campo="data_vencimento" id="task124" draggable="true" class="opcao">
                		<label>Data de Vencimento</label>
                	</div>
                	<div campo="valor_duplicata" id="task125" draggable="true" class="opcao">
                		<label>Valor da duplicata</label>
                	</div>
                	<div campo="informacoes_adicionais" id="task126" draggable="true" class="opcao">
                		<label>Informações Complementares</label>
                	</div>
                </div>

            </div>                 
         
     
     
    <div class="row">
        <div class="col" style="text-align: center;">
            <input type="button" class="btn btn-success" onclick="FiltrarColunas();" name="filtrar" id="filtro" value="Filtrar">
        </div>
    </div>

    
    
 <script type="text/javascript">
 var dropTarget = document.querySelector(".wrapper");
 var draggables = document.querySelectorAll(".opcao");

for(let x = 0; x<draggables.length; x++){
	draggables[x].addEventListener("dragstart", function(ev){
     ev.dataTransfer.setData("srcId",ev.target.id);
	});
}

dropTarget.addEventListener("dragover",function(ev){
 ev.preventDefault();
});

dropTarget.addEventListener("drop", function(ev){
	ev.preventDefault();
	let target = ev.target;
	let srcId = ev.dataTransfer.getData("srcId");
    
    let droppable = target.classList.contains("box");
    if (droppable) {
	ev.target.appendChild(document.getElementById(srcId));
 }
});

    function FiltrarColunas(){

        colunas = $("#selecionou div");

        label_colunas = [];

        for(i = 0; i < colunas.length; i++){

            label_colunas.push(colunas.eq(i).attr("campo"));

        }

        console.log(label_colunas); //ISSO AQUI SÃO TODAS AS COLUNAS QUE ELA SELECIONOU

        colunas_sql = label_colunas.join();

        console.log(colunas_sql); //TU VAI JOGAR ISSO NO SQL
        
        exportarParaExcel(colunas_sql);
    }

    


	function exportarParaExcel(sql) {
    
    array_teste = 'SELECT '+sql+' FROM nota_fiscal INNER JOIN produto ON id_nota_fiscal = id';
	dados = [];


	db.all(array_teste, [], (err, rows) => {
	  if (err) {
	    throw err;
	  }
	  rows.forEach((row) => {
	  	dados.push(Object.keys(row).map(function(_) { return row[_]; }));
	  });
		csvContent = "data:text/csv;charset=utf-8," 
	    + dados.map(e => e.join(";")).join("\n");
		var encodedUri = encodeURI(csvContent);
		var link = document.createElement("a");
		link.setAttribute("href", encodedUri);
		link.setAttribute("download", "my_data.csv");
		document.body.appendChild(link); // Required for FF

		link.click(); // This will download the data file named "my_data.csv".
	});

	}

	// exportarParaExcel();
    
   
  
    
</script>